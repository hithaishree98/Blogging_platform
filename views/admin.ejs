<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/css/admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header Section -->
    <header class="navbar">
        <div class="logo-container">
            <a href="/">
                <img src="https://cdn.glitch.global/2679bf09-2c70-4505-a2a8-7f4966f413aa/DALLE2024-12-1316.28.03-AnexquisiteandcreativelogoforTasteTrailsafoodandtravelblog.Thedesignintegratesacircularglobeinsoftpasteltonessymbolizingtra-ezgif.com-webp-to-jpg-converter.jpg?v=1734125364737" alt="Logo">
            </a>
            <a href="/" class="logo">TasteTrails</a>
        </div>
        <ul class="nav-links">
            <li><a href="/explore">Explore/Manage Blogs</a></li>
            <li><a href="/blogs/create">Create Blog</a></li>
            <li><a href="/admin">Admin Dashboard</a></li>
            <li><a href="/profile">My Profile</a></li>
            <li><a href="/auth/logout" class="btn-signup">Logout</a></li>
        </ul>
    </header>

    <!-- Main Content -->
    <main class="dashboard-container">
        <h1 class="header-title">Admin Dashboard</h1>
        
        <section class="overview">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Total Blogs</h3>
                    <p class="stat-number"><%= blogCount %></p>
                </div>
                <div class="stat-card">
                    <h3>Total Users</h3>
                    <p class="stat-number"><%= userCount %></p>
                </div>
            </div>
        </section>

        <!-- Graphs Section -->
        <section class="graphs-container">
            <!-- Bar Graph -->
            <div class="graph-section">
                <h2 class="graph-title">Average Blog Rating</h2>
                <canvas id="ratingChart"></canvas>
            </div>

            <!-- Pie Chart -->
            <div class="graph-section">
                <h2 class="graph-title">Top Destinations</h2>
                <canvas id="destinationChart"></canvas>
            </div>
          
            <div class="graph-section">
                <h2 class="graph-title">Blog Creation Trend (Last 7 Days)</h2>
                <canvas id="trendChart"></canvas>
            </div>
        </section>
    </main>

    <!-- Footer Section -->
    <footer>
        <p>&copy; 2024 TasteTrails. Crafted with love for food and travel enthusiasts.</p>
        <ul class="social-links">
            <li><a href="#">Facebook</a></li>
            <li><a href="#">Instagram</a></li>
            <li><a href="#">Twitter</a></li>
        </ul>
    </footer>

    <!-- Chart Scripts -->
    <script>
        // Bar Chart for Average Blog Rating
        const ctx = document.getElementById('ratingChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Average Rating'],
                datasets: [{
                    label: 'Average Blog Rating',
                    data: [<%= avgRating %>],
                    backgroundColor: 'rgba(221, 160, 221, 0.7)',
                    borderColor: 'rgba(76, 175, 80, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        labels: {
                            color: '#FFF',
                            font: { weight: 'bold' }
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: '#FFF', font: { weight: 'bold' } }
                    },
                    y: {
                        ticks: { color: '#FFF', font: { weight: 'bold' } }
                    }
                }
            }
        });

        // Pie Chart for Top Destinations
        const destinationCtx = document.getElementById('destinationChart').getContext('2d');
        const destinationLabels = <%- JSON.stringify(topDestinations.map(dest => dest._id)) %>;
        const destinationCounts = <%- JSON.stringify(topDestinations.map(dest => dest.count)) %>;

        new Chart(destinationCtx, {
            type: 'pie',
            data: {
                labels: destinationLabels,
                datasets: [{
                    label: 'Top Destinations',
                    data: destinationCounts,
                    backgroundColor: ['#FFADAD', '#FFD6A5', '#9BF6FF', '#A0C4FF', '#BDB2FF'],
                    borderColor: '#fff',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        labels: {
                            color: '#FFF',
                            font: { weight: 'bold' }
                        }
                    }
                }
            }
        });
      
        const trendCtx = document.getElementById('trendChart').getContext('2d');
        const trendDates = <%- JSON.stringify(trendData.dates) %>;
        const trendCounts = <%- JSON.stringify(trendData.counts) %>;

        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: trendDates,
                datasets: [{
                    label: 'Blogs Created',
                    data: trendCounts,
                    backgroundColor: 'rgba(54, 162, 235, 0.5)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 2,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        labels: {
                            color: '#FFF',
                            font: { weight: 'bold' }
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: '#FFF', font: { weight: 'bold' } }
                    },
                    y: {
                        ticks: { color: '#FFF', font: { weight: 'bold' } }
                    }
                }
            }
        });
    </script>
</body>
</html>
